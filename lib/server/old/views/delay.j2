{% extends "frame.j2" %}
{% import "partial.j2" as partial %}

{% block title %}delay{% endblock %}

{% block content %}
<!-- nav -->
<div class="row">{{ partial.nav("delay") }}</div>
<!-- ip-time table -->
<br/>
<div class="row">
    <form action="delay/edit" method="post">
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>CIDR</th>
                    <th>Delay Time (ms)</th>
                    <th><button type="button" class="btn btn-success" data-add>Add</button></th>
                </tr>
            </thead>
            <tbody data-items>
                {% for delay in delays %}
                <tr>
                    <td><input class="form-control" type="text" name="cidr" value="{{ delay.cidr }}"/></td>
                    <td><input class="form-control" type="text" name="time" value="{{ delay.time }}"/></td>
                    <td><button class="btn btn-danger" type="button" data-del>Del</button></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <div class="col-md-2 col-md-offset-5">
            <button class="btn btn-primary btn-block" type="submit">Submit</button>
        </div>
    </form>
</div>
<!-- item[add/del] & form submit -->
<script>
$(document).ready(function()
{
    $(document).on('click', 'button[data-del]', function()
    {
        $(this).parent().parent().remove();
    });

    $(document).on('click', 'button[data-add]', function()
    {
        var tr = $('<tr>');

        for (name of ['cidr', 'time'])
        {
            var input = $('<input>',
            {
                'class'   : 'form-control',
                'type'    : 'text',
                'name'    : name,
            });

            var td = $('<td>');
            td.html($(input));
            tr.append($(td));
        }

        var btn = $('<button>',
        {
            'class'    : 'btn btn-danger',
            'type'     : 'button',
            'data-del' : ''
        });
        btn.text('Del');

        var td = $('<td>');
        td.html($(btn));
        tr.append($(td));

        $('tbody[data-items]').append($(tr));
    });
});
</script>
{% endblock %}